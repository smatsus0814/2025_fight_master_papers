<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>ファイト！</title>

</head>
<body>
    <h1>修士論文カウントダウン＆おみくじ＆残文字数計算機</h1>
    <img id="floating-image" src="fight_miura.png" alt="浮揚する画像">

    <p>（注）本カウントダウンはすべて日本時間（Japan Standard Time）を基準としています。</p>

    <div id="tokyo-countdown" class="countdown"></div>
    <div id="kyushu-countdown" class="countdown"></div>

    <button id="fortune">今日の運勢を占う</button>
    <div id="fortune-result"></div>

    <h1>残り文字数チェッカー</h1>

    <div id="inputs">
        <label for="remaining-characters">残りの文字数:</label>
        <input type="number" id="remaining-characters" value="20000">
        <label for="sleep-hours">睡眠時間（時間）:</label>
        <input type="number" id="sleep-hours" value="6">
        <label for="work-hours">バイト等の時間（時間）:</label>
        <input type="number" id="work-hours" value="4">
    </div>

    <select id="deadline-selector">
        <option value="tokyo" selected>東京大学基準</option>
        <option value="kyushu">九州大学基準</option>
    </select>
    
    
    <div id="writing-speed">
        <p>単位時間あたりの必要執筆文字数:</p>
        <p>24時間あたり: <span id="speed-24"></span>文字</p>
        <p>6時間あたり: <span id="speed-6"></span>文字</p>
        <p>1時間あたり: <span id="speed-1"></span>文字</p>
        <p>30分あたり: <span id="speed-0_5"></span>文字</p>
        <p>1分あたり: <span id="speed-0_016"></span>文字</p>
        <p>30秒あたり: <span id="speed-0_008"></span>文字</p>
    </div>

    <script>
        function updateCountdown() {
            const now = new Date();

            const tokyoDeadline = new Date("2025-01-09T16:00:00+09:00");
            const kyushuDeadline = new Date("2025-01-20T17:00:00+09:00");

            const tokyoDiff = tokyoDeadline - now;
            const kyushuDiff = kyushuDeadline - now;

            document.getElementById("tokyo-countdown").innerText =
                `東京大学大学院教育学研究科:\n残り ${formatTime(tokyoDiff)}`+
                `\n（2025年1月9日　16:00）`;

            document.getElementById("kyushu-countdown").innerText =
                `九州大学大学院人間環境学府教育システム専攻:\n残り ${formatTime(kyushuDiff)}` +
                `\n（2025年1月20日　17:00）`;

            const selector = document.getElementById("deadline-selector").value;
            const deadline = selector === "tokyo" ? tokyoDiff : kyushuDiff;

            calculateWritingSpeed(deadline);
        }

        function formatTime(diff) {
            if (diff <= 0) return "期限が過ぎました！";

            const totalHours = Math.floor(diff / (1000 * 60 * 60)); // 総時間数に変換
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);
            const milliseconds = diff % 1000; // ミリ秒を計算

            return `${totalHours}時間 ${minutes}分 ${seconds}秒 ${milliseconds}ミリ秒`;
        }


        function calculateWritingSpeed(diff) {
            const remainingCharacters = parseInt(document.getElementById("remaining-characters").value);
            const sleepHours = parseInt(document.getElementById("sleep-hours").value);
            const workHours = parseInt(document.getElementById("work-hours").value);

            if (diff <= 0 || isNaN(remainingCharacters) || isNaN(sleepHours) || isNaN(workHours)) {
                document.getElementById("speed-24").innerText = "-";
                document.getElementById("speed-6").innerText = "-";
                document.getElementById("speed-1").innerText = "-";
                document.getElementById("speed-0_5").innerText = "-";
                document.getElementById("speed-0_016").innerText = "-";
                document.getElementById("speed-0_008").innerText = "-";
                return;
            }

            const totalHours = diff / (1000 * 60 * 60);
            const availableHours = totalHours - sleepHours - workHours;

            if (availableHours <= 0) {
                document.getElementById("speed-24").innerText = "-";
                document.getElementById("speed-6").innerText = "-";
                document.getElementById("speed-1").innerText = "-";
                document.getElementById("speed-0_5").innerText = "-";
                document.getElementById("speed-0_016").innerText = "-";
                document.getElementById("speed-0_008").innerText = "-";
                return;
            }

            const speedPerHour = remainingCharacters / availableHours;

            document.getElementById("speed-24").innerText = (speedPerHour * 24).toFixed(2);
            document.getElementById("speed-6").innerText = (speedPerHour * 6).toFixed(2);
            document.getElementById("speed-1").innerText = speedPerHour.toFixed(2);
            document.getElementById("speed-0_5").innerText = (speedPerHour / 2).toFixed(2);
            document.getElementById("speed-0_016").innerText = (speedPerHour / 60).toFixed(2);
            document.getElementById("speed-0_008").innerText = (speedPerHour / 120).toFixed(2);
        }

        setInterval(updateCountdown, 100);

        let fortuneTimeout;
        document.getElementById("fortune").addEventListener("click", () => {
            if (fortuneTimeout) return;

            const fortunes = [
                "大吉 - 素晴らしい研究成果が期待できます！",
                "中吉 - 少し頑張れば結果が出ます！",
                "小吉 - 地道な努力が必要です！",
                "凶 - 注意が必要な日です...",
                "大凶 - 大凶 - 今日は無理せず休みたいですね。\n感染症、交通事故、食あたりには気をつけましょう。"
            ];
            const result = fortunes[Math.floor(Math.random() * fortunes.length)];
            document.getElementById("fortune-result").innerText = result + 
                "\n（おみくじ連打はNG！10秒お待ちください）";

            document.getElementById("fortune").disabled = true;
            fortuneTimeout = setTimeout(() => {
                document.getElementById("fortune").disabled = false;
                fortuneTimeout = null;
            }, 10000);
        });
    </script>

    <script>
        // 広告要素の作成
        const adOverlay = document.createElement('div');
        adOverlay.style.position = 'fixed';
        adOverlay.style.top = '0';
        adOverlay.style.left = '0';
        adOverlay.style.width = '100%';
        adOverlay.style.height = '100%';
        adOverlay.style.backgroundColor = 'rgba(0, 0, 0, 0.6)';
        adOverlay.style.zIndex = '9999';
        adOverlay.style.display = 'flex';
        adOverlay.style.alignItems = 'center';
        adOverlay.style.justifyContent = 'center';

        // PNG画像を配置
        const adImage = document.createElement('img');
        adImage.src = './fight_miura.png'; // ここに表示したいPNG画像のパスを入力
        adImage.style.width = '300px'; // 画像サイズを調整
        adImage.style.height = 'auto';
        adImage.style.position = 'relative';
        adOverlay.appendChild(adImage);

        // 閉じるボタン
        const closeButton = document.createElement('button');
        closeButton.innerText = '✖';
        closeButton.style.position = 'absolute';
        closeButton.style.top = '10px';
        closeButton.style.right = '10px';
        closeButton.style.padding = '10px';
        closeButton.style.backgroundColor = 'white';
        closeButton.style.color = 'black';
        closeButton.style.border = 'none';
        closeButton.style.cursor = 'pointer';
        closeButton.style.zIndex = '10000'; // ボタンが最前面になるよう調整
        adOverlay.appendChild(closeButton);

        // 閉じるボタンをランダムに動かす
        function moveCloseButton() {
            const randomTop = Math.random() * 80 + '%';
            const randomLeft = Math.random() * 80 + '%';
            closeButton.style.top = randomTop;
            closeButton.style.left = randomLeft;
        }
        setInterval(moveCloseButton, 1000);

        // 浮遊アニメーション
        let adX = 0;
        let adY = 0;
        let xDirection = 1;
        let yDirection = 1;
        function floatAd() {
            adX += xDirection * 2;
            adY += yDirection * 2;

            if (adX > window.innerWidth - 300 || adX < 0) xDirection *= -1; // 幅300px基準
            if (adY > window.innerHeight - 300 || adY < 0) yDirection *= -1;

            adImage.style.transform = `translate(${adX}px, ${adY}px)`;
        }
        setInterval(floatAd, 50);

        // 広告の表示
        document.body.appendChild(adOverlay);

        // 広告を閉じる
        closeButton.addEventListener('click', () => {
            adOverlay.remove();
            setTimeout(() => {
                document.body.appendChild(adOverlay); // 数秒後に広告を再び表示
            }, 3000);
        });
    </script>



</body>
</html>
